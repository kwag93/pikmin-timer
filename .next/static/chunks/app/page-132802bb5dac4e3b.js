(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{8791:function(e,t,n){Promise.resolve().then(n.bind(n,6682))},6682:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return D}});var r=n(288),a=n(5192);let i="pikmin-timers",s=null;function l(){try{s||(s=new AudioContext),"suspended"===s.state&&s.resume();let e=s.createOscillator(),t=s.createGain();e.connect(t),t.connect(s.destination),e.frequency.setValueAtTime(800,s.currentTime),e.frequency.setValueAtTime(1e3,s.currentTime+.15),t.gain.setValueAtTime(.3,s.currentTime),t.gain.exponentialRampToValueAtTime(.001,s.currentTime+.5),e.start(s.currentTime),e.stop(s.currentTime+.5)}catch(e){}}function o(e){let{activeCount:t}=e;return(0,r.jsx)("header",{className:"sticky top-0 z-30 w-full bg-emerald-800/80 backdrop-blur-md",children:(0,r.jsxs)("div",{className:"max-w-6xl mx-auto px-4 py-3 flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"text-2xl","aria-hidden":"true",children:"\uD83C\uDF44"}),(0,r.jsx)("h1",{className:"text-lg font-bold text-white tracking-tight",children:"Pikmin Bloom Timer"})]}),t>0&&(0,r.jsx)("div",{className:"flex items-center justify-center w-7 h-7 rounded-full bg-yellow-400 text-emerald-900 text-sm font-bold shadow","aria-label":"활성 타이머 ".concat(t,"개"),children:t})]})})}var c=n(5807),d=n(2611),u=n(7517);let m={safe:"hsl(128, 42%, 42%)",warn:"hsl(42, 95%, 52%)",danger:"hsl(14, 90%, 58%)",done:"hsl(0, 72%, 52%)"},x={safe:{text:"text-green-600",bg:"bg-green-50",border:"border-green-400",progress:"stroke-green-500"},warn:{text:"text-yellow-600",bg:"bg-yellow-50",border:"border-yellow-400",progress:"stroke-yellow-500"},danger:{text:"text-orange-600",bg:"bg-orange-50",border:"border-orange-400",progress:"stroke-orange-500"},done:{text:"text-red-600",bg:"bg-red-50",border:"border-red-400",progress:"stroke-red-500"}},f={initial:{opacity:0,scale:.85,y:16},animate:{opacity:1,scale:1,y:0,transition:{type:"spring",stiffness:320,damping:24}},exit:{opacity:0,scale:.9,y:-8,transition:{duration:.22,ease:"easeIn"}}},h={initial:{opacity:0,y:-24},animate:{opacity:1,y:0,transition:{duration:.35,ease:[.22,1,.36,1]}}},g={whileHover:{scale:1.06,y:-2},whileTap:{scale:.94}};function p(e){let{progress:t,phase:n,size:a=112}=e,i=2*Math.PI*52;return(0,r.jsxs)("svg",{width:a,height:a,viewBox:"0 0 120 120",style:{transform:"rotate(-90deg)"},children:[(0,r.jsx)("circle",{cx:"60",cy:"60",r:52,fill:"none",stroke:"hsl(0, 0%, 89%)",strokeWidth:"6"}),(0,r.jsx)("circle",{cx:"60",cy:"60",r:52,fill:"none",stroke:m[n],strokeWidth:"6",strokeLinecap:"round",strokeDasharray:i,strokeDashoffset:i*(1-Math.max(0,Math.min(1,t))),style:{transition:"stroke-dashoffset 1s linear, stroke 0.5s ease"}})]})}function b(e){let{phase:t,size:n=40}=e,a=m[t];return(0,r.jsxs)("svg",{width:n,height:n,viewBox:"0 0 40 40",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,r.jsx)("rect",{x:"14",y:"24",width:"12",height:"12",rx:"3",fill:"hsl(30, 40%, 72%)"}),(0,r.jsx)("ellipse",{cx:"20",cy:"22",rx:"16",ry:"12",fill:a,style:{transition:"fill 0.5s ease"}}),(0,r.jsx)("circle",{cx:"14",cy:"19",r:"2.5",fill:"white",opacity:"0.85"}),(0,r.jsx)("circle",{cx:"22",cy:"15",r:"2",fill:"white",opacity:"0.85"}),(0,r.jsx)("circle",{cx:"28",cy:"20",r:"2",fill:"white",opacity:"0.85"})]})}let y=a.memo(function(e){let{timer:t,now:n,onRemove:a}=e,i=Math.max(0,t.endAt-n),s=Math.ceil(i/1e3),l=1-i/t.durationMs,o=s<=0?"done":s<=60?"danger":s<=180?"warn":"safe",c=x[o],m="done"===o;return(0,r.jsxs)(d.E.div,{variants:f,initial:"initial",animate:"animate",exit:"exit",layout:!0,className:["relative flex flex-col items-center gap-3 p-4 rounded-2xl border-2","bg-white/85 backdrop-blur-sm shadow-md",c.border,m?"animate-timer-done":""].join(" "),children:[(0,r.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,r.jsx)("span",{className:"text-sm font-semibold text-gray-700 truncate max-w-[80%]",children:t.label||"타이머"}),(0,r.jsx)("button",{onClick:()=>a(t.id),className:"text-gray-400 hover:text-red-500 transition-colors flex-shrink-0 ml-1","aria-label":"타이머 삭제",children:(0,r.jsx)(u.Z,{size:16})})]}),(0,r.jsxs)("div",{className:"relative flex items-center justify-center",children:[(0,r.jsx)(p,{progress:l,phase:o,size:112}),(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,r.jsx)(b,{phase:o,size:40})})]}),m?(0,r.jsx)("span",{className:["text-2xl font-bold font-timer tabular-nums",c.text].join(" "),children:"리스폰!"}):(0,r.jsx)("span",{className:["text-4xl font-bold font-timer tabular-nums",c.text].join(" "),children:"".concat(Math.floor(s/60),":").concat((s%60).toString().padStart(2,"0"))})]})});function w(e){let{timers:t,now:n,onRemoveTimer:a}=e;return 0===t.length?(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-16 text-white/80",children:[(0,r.jsx)("span",{className:"text-5xl mb-3",children:"\uD83C\uDF44"}),(0,r.jsx)("p",{className:"text-lg font-medium",children:"타이머를 추가하세요"}),(0,r.jsx)("p",{className:"text-sm mt-1 text-white/60",children:"위 폼에서 시간을 설정하세요"})]}):(0,r.jsx)("div",{className:"w-full grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:(0,r.jsx)(c.M,{mode:"popLayout",children:t.map(e=>(0,r.jsx)(y,{timer:e,now:n,onRemove:a},e.id))})})}let j=[{label:"+5분",durationSeconds:300,description:"리스폰 대기"},{label:"+8분",durationSeconds:480,description:"3분 남음 + 리스폰"},{label:"+10분",durationSeconds:600,description:"5분 남음 + 리스폰"},{label:"+15분",durationSeconds:900,description:"10분 남음 + 리스폰"}];function v(e){let{onSelect:t,disabled:n=!1}=e;return(0,r.jsx)("div",{className:"flex flex-wrap gap-2 justify-center",children:j.map(e=>(0,r.jsx)(d.E.button,{type:"button",onClick:()=>t(e.durationSeconds,e.label),disabled:n,whileHover:n?void 0:g.whileHover,whileTap:n?void 0:g.whileTap,className:"px-3 py-1.5 rounded-full bg-sky-100 hover:bg-sky-200 text-sky-800 text-sm font-medium border border-sky-300 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:e.description,children:e.label},e.label))})}function N(e){let{onAddTimer:t,canAddTimer:n}=e,[i,s]=(0,a.useState)(5),[l,o]=(0,a.useState)(0),[c,u]=(0,a.useState)("");return(0,r.jsxs)(d.E.form,{onSubmit:e=>{e.preventDefault();let n=60*i+l;n<=0||(t(n,c),s(5),o(0),u(""))},variants:h,initial:"initial",animate:"animate",className:"w-full max-w-md bg-white/85 backdrop-blur-sm rounded-2xl shadow-lg p-5 flex flex-col gap-4",children:[(0,r.jsx)(v,{onSelect:(e,n)=>{t(e,n)},disabled:!n}),(0,r.jsxs)("div",{className:"flex items-end gap-3 justify-center",children:[(0,r.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[(0,r.jsx)("label",{htmlFor:"minutes",className:"text-xs text-gray-500 font-medium",children:"분"}),(0,r.jsx)("input",{id:"minutes",type:"number",value:i,onChange:e=>s(Math.max(0,Math.min(30,Number(e.target.value)))),min:"0",max:"30",className:"w-20 px-3 py-2 border-2 border-green-300 rounded-xl text-center text-2xl font-bold text-green-800 focus:outline-none focus:border-green-500 focus:ring-2 focus:ring-green-200 bg-green-50"})]}),(0,r.jsx)("span",{className:"text-2xl font-bold text-gray-400 mb-2",children:":"}),(0,r.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[(0,r.jsx)("label",{htmlFor:"seconds",className:"text-xs text-gray-500 font-medium",children:"초"}),(0,r.jsx)("input",{id:"seconds",type:"number",value:l,onChange:e=>o(Math.max(0,Math.min(59,Number(e.target.value)))),min:"0",max:"59",className:"w-20 px-3 py-2 border-2 border-green-300 rounded-xl text-center text-2xl font-bold text-green-800 focus:outline-none focus:border-green-500 focus:ring-2 focus:ring-green-200 bg-green-50"})]})]}),(0,r.jsx)("input",{type:"text",value:c,onChange:e=>u(e.target.value),placeholder:"타이머 이름 (선택)",maxLength:20,className:"w-full px-4 py-2.5 border-2 border-gray-200 rounded-xl text-center focus:outline-none focus:border-green-400 focus:ring-2 focus:ring-green-100 text-gray-700 placeholder-gray-400"}),(0,r.jsx)("button",{type:"submit",disabled:!n||60*i+l<=0,className:"w-full py-3 bg-emerald-600 hover:bg-emerald-700 text-white font-semibold rounded-xl transition-colors focus:outline-none focus:ring-2 focus:ring-emerald-400 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed shadow-sm",children:n?"타이머 시작 \uD83C\uDF44":"최대 8개까지 생성 가능합니다"})]})}let k=["\uD83C\uDF38","\uD83C\uDF3C","\uD83C\uDF3A"];function C(){let[e,t]=(0,a.useState)([]),[n,i]=(0,a.useState)([]);return(0,a.useEffect)(()=>{t(Array.from({length:12},(e,t)=>({id:t,x:100*Math.random(),y:100*Math.random(),emoji:k[t%k.length],duration:3+3*Math.random(),delay:2*Math.random()}))),i(Array.from({length:6},(e,t)=>({id:t,x:100*Math.random(),y:-10,emoji:"\uD83C\uDF43",duration:7+4*Math.random(),delay:6*Math.random()})))},[]),(0,r.jsxs)("div",{className:"fixed inset-0 pointer-events-none z-0 overflow-hidden",children:[(0,r.jsxs)("svg",{className:"absolute bottom-0 left-0 w-full",viewBox:"0 0 1440 160",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"none",children:[(0,r.jsx)("path",{d:"M0,80 C240,160 480,0 720,80 C960,160 1200,20 1440,80 L1440,160 L0,160 Z",fill:"hsl(130, 45%, 28%)",opacity:"0.7"}),(0,r.jsx)("path",{d:"M0,110 C360,40 720,160 1080,80 C1260,50 1380,120 1440,110 L1440,160 L0,160 Z",fill:"hsl(128, 42%, 42%)",opacity:"0.6"})]}),e.map(e=>(0,r.jsx)(d.E.span,{className:"absolute text-2xl select-none",style:{left:"".concat(e.x,"%"),top:"".concat(e.y,"%"),opacity:.4},animate:{rotate:[-6,6,-6]},transition:{duration:e.duration,delay:e.delay,repeat:1/0,ease:"easeInOut"},"aria-hidden":"true",children:e.emoji},e.id)),n.map(e=>(0,r.jsx)("span",{className:"absolute text-xl select-none",style:{left:"".concat(e.x,"%"),top:0,animationName:"leaf-fall",animationDuration:"".concat(e.duration,"s"),animationDelay:"".concat(e.delay,"s"),animationTimingFunction:"linear",animationIterationCount:"infinite"},"aria-hidden":"true",children:e.emoji},e.id))]})}function D(){let{timers:e,now:t,addTimer:n,removeTimer:c,clearCompleted:d,canAddTimer:u}=function(){let[e,t]=(0,a.useState)(()=>(function(){try{let e=localStorage.getItem(i);if(!e)return[];let t=JSON.parse(e),n=Date.now();return t.map(e=>"running"===e.status&&e.endAt<=n?{...e,status:"completed"}:e)}catch(e){return[]}})()),[n,r]=(0,a.useState)(Date.now());(0,a.useEffect)(()=>{let e=setInterval(()=>r(Date.now()),1e3);return()=>clearInterval(e)},[]),(0,a.useEffect)(()=>{let e=()=>{"visible"===document.visibilityState&&r(Date.now())};return document.addEventListener("visibilitychange",e),()=>document.removeEventListener("visibilitychange",e)},[]),(0,a.useEffect)(()=>{t(e=>{let t=e.map(e=>"running"===e.status&&e.endAt<=n?{...e,status:"completed"}:e);return t.some((t,n)=>t.status!==e[n].status)?t:e})},[n]),(0,a.useEffect)(()=>{!function(e){try{localStorage.setItem(i,JSON.stringify(e))}catch(e){}}(e)},[e]);let s=(0,a.useCallback)((n,r)=>{if(e.length>=8)return;let a=Date.now(),i=1e3*n;t(e=>[...e,{id:crypto.randomUUID(),label:r||"버섯 ".concat(e.length+1),createdAt:a,durationMs:i,endAt:a+i,status:"running"}])},[e.length]);return{timers:e,now:n,addTimer:s,removeTimer:(0,a.useCallback)(e=>{t(t=>t.filter(t=>t.id!==e))},[]),dismissTimer:(0,a.useCallback)(e=>{t(t=>t.map(t=>t.id===e?{...t,status:"dismissed"}:t))},[]),clearCompleted:(0,a.useCallback)(()=>{t(e=>e.filter(e=>"running"===e.status))},[]),canAddTimer:e.length<8}}(),{permission:m,requestPermission:x,notify:f}=function(){let[e,t]=(0,a.useState)("undefined"!=typeof Notification?Notification.permission:"default"),n=(0,a.useCallback)(async()=>{if("undefined"==typeof Notification)return"denied";let e=await Notification.requestPermission();return t(e),e},[]),r=(0,a.useCallback)((t,n)=>{if("granted"!==e)return null;try{return new Notification(t,{icon:"/pikmin-icon.png",tag:"pikmin-timer",...n})}catch(e){return null}},[e]);return{permission:e,requestPermission:n,notify:r}}();!function(e){let{timers:t,now:n,onTimerComplete:r,notify:i}=e,s=(0,a.useRef)(new Set),o=(0,a.useRef)(new Map);(0,a.useEffect)(()=>(t.forEach(e=>{if("running"!==e.status||s.current.has(e.id)||o.current.has(e.id))return;let t=e.endAt-Date.now();if(t<=0)return;let n=setTimeout(()=>{s.current.has(e.id)||(s.current.add(e.id),i("\uD83C\uDF44 ".concat(e.label," 리스폰!"),{body:"버섯이 다시 나타났어요!"}),l(),null==r||r(e)),o.current.delete(e.id)},t);o.current.set(e.id,n)}),()=>{let e=new Set(t.map(e=>e.id));o.current.forEach((t,n)=>{e.has(n)||(clearTimeout(t),o.current.delete(n))})}),[t,i,r]),(0,a.useEffect)(()=>{t.forEach(e=>{"running"===e.status&&e.endAt<=n&&!s.current.has(e.id)&&(s.current.add(e.id),i("\uD83C\uDF44 ".concat(e.label," 리스폰!"),{body:"버섯이 다시 나타났어요!"}),l(),null==r||r(e))})},[t,n,i,r]),(0,a.useEffect)(()=>{let e=new Set(t.map(e=>e.id));s.current.forEach(t=>{e.has(t)||s.current.delete(t)})},[t]),(0,a.useEffect)(()=>()=>{o.current.forEach(clearTimeout),o.current.clear()},[])}({timers:e,now:t,notify:f});let h=async(e,t)=>{"default"===m&&await x(),s||(s=new AudioContext),n(e,t)},g=e.filter(e=>"running"===e.status).length;return(0,r.jsxs)("main",{className:"relative min-h-screen bg-gradient-to-b from-sky-400 via-sky-300 to-emerald-200",children:[(0,r.jsx)(C,{}),(0,r.jsx)(o,{activeCount:g}),(0,r.jsxs)("div",{className:"relative z-10 w-full max-w-6xl mx-auto px-4 py-6 flex flex-col items-center gap-6",children:[(0,r.jsx)(N,{onAddTimer:h,canAddTimer:u}),(0,r.jsx)(w,{timers:e,now:t,onRemoveTimer:c}),e.some(e=>"running"!==e.status)&&(0,r.jsx)("button",{onClick:d,className:"fixed bottom-6 right-6 z-20 px-4 py-2.5 bg-red-500/90 hover:bg-red-600 backdrop-blur-sm text-white text-sm font-medium rounded-full shadow-lg transition-all",children:"완료된 타이머 정리"})]})]})}}},function(e){e.O(0,[461,24,240,744],function(){return e(e.s=8791)}),_N_E=e.O()}]);